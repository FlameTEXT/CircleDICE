# 确定一下方向性问题

## Dice 相关指令

### bot 一定程度上管理机器人

- on
- off
- exit

### set 设置群组使用规则

- <exp> `set 1d20` r 指令中默认的 1d100 修改为 1d20
- coc 为默认规则，因为目前来看国内使用 COC 规则的人数相对多
  - 1 房规
  - 找到现在房规的来源了，塔的加减法。

- dnd
- ……

### r 投骰

> 为了方便指令格式的规范，收集了一些常见的投骰系统
>
> - D20
>   投掷二十面骰加上调整对抗DC
>
> - Risus（d6）
>   相加判断上限
> - ST（d10）
>   采用的骰子为十面骰，骰出等于骰池的十面骰算出成功度对比难度等级决定成败。
> - BRP（d100）
>   其判定为投掷两个十面骰，一个作为十位一个作为个位，低于等于技能等级便算成功。（coc）
> - FUDGE（d6？）
>   判定使用特殊的六面骰，两个对面标记+，两个对面标记-，剩下两个面没有标记。检定时投四枚Fudge骰（记作4dF）并相加面值（正负互相抵消，无标记面是零）加上技能调整来决定结果。
> - SRS（2d6）
>   判定时玩家需要投掷两个六面骰子，面数总数加上能力/等级调整大于或等于难度等级便算成功。多用用日系规则

- r 目前打算使用 [koishijs/onedice.js](https://github.com/koishijs/onedice.js) ，日后再说。
 - rc 技能检定指令 根据 set 改变
- ra 技能检定指令 // ra -> rc 、rc 表示不是房规也太（）
- rt 武器伤害
- ri 先攻

### pc 管理角色卡

- pc new 新建一名角色

- pc list 查看角色列表

- pc rm 从列表中删除一位角色

- pc view 查看角色信息

- pc bind 绑定/解绑，在当前群

- pc nn 重命名当前角色 -> st name=某某名字

- pc all on/off 设置全局模式

> 关于 pc all 的情形推演。
>
> 1、如果一个人只有一个团，而且只在一个群使用，那么他根本不需要 pc bind
>
> 2、如果这是一个秘密团，需要在多个群使用，这时候全局人物卡是良好的设计，免于频繁 pc bind
>
> 3、如果他有多个团，那么每群自动 st 时自动新建一张卡是良好，免于频繁 pc bind
>
> 4、如果他有多个团，而且都是秘密团，这个时候无论如何必须使用 pc bind
>
> 可以看出 2 和 3 是矛盾的情形，一个希望全局卡，一个反对，我们无法确定玩家的行为模式，因此解决方法是加个开关（pc all），由玩家自己选择是否开启；而对于骰主，这个开关的默认状态是由自己决定的。
>
> 

要实现上面的代码，意味着 getch 方法要内部判断这一切，这需要群/人两个字段必须永久存在，如果缺失就报一个 warn 使用模范角色卡。

*
人物卡获取流程：

先判断有无绑定卡有直接返回

判断有无卡片

有判断是否全局

*
全局卡：默认使用的卡片

绑定卡：只在特定群使用的卡片

*

默认属性值。

*

角色获取流程。

*

st 录入数据

*

sn

  　　

### log 记录跑团日志

- on 开启

  - 为空 且 没有最近日志文件的时候 询问新建日志名

- off 关闭日志

- list 

  - rm 删除 list 中日志

- get 生成日志文件 如果可能 发送源文件

- recall 按照时间生成 log 文件

  > log recall 4h 就能获取 4h 内的 log 防止忘开log
  >
  > 相应的，恐怕需要控制文件大小
  >
  > 每小时针对各群生成一个 qq-123456-recall.log 文件，并删除 24h（or 240h） 之前的
  >
  > // 废弃，用 log get recall 即可
  
  **文件格式**
  
  > 至少本项目内，不打算实现 log 染色网站。
  >
  > 而现在大多数 log 染色器都支持 qq 记录导出后的格式，只要生成 log 文件符合这个要求，染色可以交给其他网站
  >
  > log 文件格式规定： 协议平台-群组号-日志名-6位随机数.txt UTB-8 编码
  >
  > 而对于获取 log 方式更推荐使用 gocq 上传文件 api
  >
  > —— 其他协议平台可能没有类似 api ，作为临时代替方案考虑：
  >
  > [transfer.sh - 从命令行轻松快速地共享文件](https://transfer.sh/)
  >
  > [钛盘 - 超好用的文件中转站 (tmp.link)](https://tmp.link/)
  >
  > // 看来没有脱离初衷？

### deck 抽取物品/项目

### init 先攻 等

## 指令别名

- st -> pc st
- dismiss -> bot exit
- nn -> pc nn

- sc -> ra

## 数据存储

为了方便其他人开发，数据存储不打算使用数据库，而是文本文件的形式。

[data.md](./data.md)









